server:
  maxThreads: 1024
  minThreads: 1024
  applicationConnectors:
    - type: http
      port: 8080
  adminConnectors:
    - type: http
      port: 8081
      acceptorThreads: 4
      selectorThreads: 8
      acceptQueueSize: 1000
  applicationContextPath: /
  requestLog:
    appenders:
      - type: console
        timeZone: IST
  adminMaxThreads: 16
  adminMinThreads: 16

logging:
  level: INFO
  loggers:
    org.hibernate: WARN
  appenders:
    - type: console
      threshold: INFO
      timeZone: IST
      logFormat: "%(%-5level) [%date] [%thread] [%logger{0}]: %message%n"

shardedDB:
  shards:
    - driverClass: org.mariadb.jdbc.Driver
      user: tom
      password:
      url: jdbc:mariadb:://stg-galera001.phonepe.nm3/objects_shard1?createDatabaseIfNotExist=true
      properties:
        charSet: UTF-8
        hibernate.dialect: org.hibernate.dialect.MySQLDialect
        #hibernate.hbm2ddl.auto: create
      maxWaitForConnection: 7200s
      validationQuery: "/* MyApplication Health Check */ SELECT 1"
      minSize: 32
      maxSize: 32
      initialSize: 32
      logAbandonedConnections: true
      logValidationErrors: true
      checkConnectionWhileIdle: true
      checkConnectionOnConnect: true
      validationQueryTimeout: 1s
      removeAbandoned: true
      evictionInterval: 30s
      minIdleTime: 1m

    - driverClass: org.mariadb.jdbc.Driver
      user: tom
      password:
      url: jdbc:mariadb:://stg-galera001.phonepe.nm3/objects_shard2?createDatabaseIfNotExist=true
      properties:
        charSet: UTF-8
        hibernate.dialect: org.hibernate.dialect.MySQLDialect
        #hibernate.hbm2ddl.auto: create
      maxWaitForConnection: 7200s
      validationQuery: "/* MyApplication Health Check */ SELECT 1"
      minSize: 32
      maxSize: 32
      initialSize: 32
      logAbandonedConnections: true
      logValidationErrors: true
      checkConnectionWhileIdle: true
      checkConnectionOnConnect: true
      validationQueryTimeout: 1s
      removeAbandoned: true
      evictionInterval: 30s
      minIdleTime: 1m

    - driverClass: org.mariadb.jdbc.Driver
      user: tom
      password:
      url: jdbc:mariadb:://stg-galera001.phonepe.nm3/objects_shard3?createDatabaseIfNotExist=true
      properties:
        charSet: UTF-8
        hibernate.dialect: org.hibernate.dialect.MySQLDialect
        #hibernate.hbm2ddl.auto: create
      maxWaitForConnection: 7200s
      validationQuery: "/* MyApplication Health Check */ SELECT 1"
      minSize: 32
      maxSize: 32
      initialSize: 32
      logAbandonedConnections: true
      logValidationErrors: true
      checkConnectionWhileIdle: true
      checkConnectionOnConnect: true
      validationQueryTimeout: 1s
      removeAbandoned: true
      evictionInterval: 30s
      minIdleTime: 1m

    - driverClass: org.mariadb.jdbc.Driver
      user: tom
      password:
      url: jdbc:mariadb:://stg-galera001.phonepe.nm3/objects_shard4?createDatabaseIfNotExist=true
      properties:
        charSet: UTF-8
        hibernate.dialect: org.hibernate.dialect.MySQLDialect
        #hibernate.hbm2ddl.auto: create
      maxWaitForConnection: 7200s
      validationQuery: "/* MyApplication Health Check */ SELECT 1"
      minSize: 32
      maxSize: 32
      initialSize: 32
      logAbandonedConnections: true
      logValidationErrors: true
      checkConnectionWhileIdle: true
      checkConnectionOnConnect: true
      validationQueryTimeout: 1s
      removeAbandoned: true
      evictionInterval: 30s
      minIdleTime: 1m

discovery:
  namespace: phonepe
  environment: preprod
  zookeeper: stg-appmesosm001.phonepe.nm3:2181
  publishedHost: ${HOST}
  publishedPort: ${PORT_8080}

riemann:
  host: riemann-app.phonepe.nm1
  port: 5555
  prefix: phonepe.preprod.scroll
  pollingInterval: 30
  tags:
    - scroll

eventIngestor:
  environment: preprod
  serviceName: dp-ingestion-api
  namespace: phonepe
  clientType: queued
  queuePath: /var/log/scroll/${MARATHON_APP_ID}

swagger:
  resourcePackage: com.phonepe.platform.scroll.resources

userService:
  usingZookeeper: true
  environment: preprod
  serviceName: users
  connections: 10
  idleTimeOutSeconds: 10

configService:
  usingZookeeper: false
  host: configservice.traefik.stg.phonepe.nm3
  port: 80
  connections: 10
  idleTimeOutSeconds: 10

urlShortener:
  http:
    usingZookeeper: false
    host: urlshortener.traefik.preprod.phonepe.com
    port: 80
    connections: 10
    idleTimeOutSeconds: 10
  domain: phon.pe
  defaultURL: "https://phonepe.com"
  secure: false

tncService:
  usingZookeeper: false
  connections: 10
  idleTimeOutSeconds: 10

notificationConfig:
  mode: ASYNC
  actorConfig:
    prefetchCount: 1
    concurrency: 10
    prefix: scroll.actor
    exchange: scroll.notification
    retryConfig:
      type: COUNT_LIMITED_EXPONENTIAL_BACKOFF
      maxAttempts: 6
      multipier: 10
      maxTimeBetweenRetries: 10s

rmqConfig:
  brokers:
    - host: stg-rmq001.phonepe.nm3
      port: 25672
  userName: admin
  password: admin
  secure: false
  threadPoolSize: 50

tagEngineConfig:
  pathExpressionConfigPath: /v1/phonepe/scroll-tag-engine/preprod

flipcastConfig:
  http:
    usingZookeeper: true
    environment: preprod
    serviceName: flipcast
    connections: 10
    idleTimeOutSeconds: 10
  configName: phonepe
  pushNotificationProfileName: default
  pushNotificationPriority: default
  emailProfileName: transactionEmail
  emailSenderName: PhonePe
  emailSenderId: noreply@phonepe.com

hbaseConfig:
  secure : false
  hbaseZookeeperParent: /hbase-unsecure
  hbaseZookeeperQuorum: stg-hdp001.phonepe.nm3:2181
  hbaseZookeeperClientPort: 2181
  useHbaseWD: true
  hbaseWDBucketSize: 32
  scrollTableName: scroll-primary-v1
  auditUpdatesTableName: scroll-audit-update-v1
  auditTimelineTableName: scroll-audit-timeline-v1
  taskTableName: scroll-task-v1
  parkingStationTableName: scroll-parking-station-v1
  markerTableName: scroll-marker-v1
  auditFetchBatchSize: 500

elasticSearchConfig:
  hosts:
    - stg-hdp001.phonepe.nm3
  cluster: scroll
  indexType: entity
  indexPrefix: scroll-v1-
  indexMappingConfigServicePath: /v1/phonepe/scroll-elasticsearch-index-config/preprod

teflonConfig:
  classPath: "com.phonepe.platform.scroll"
  actorConfig:
    prefetchCount: 1
    concurrency: 3
    prefix: scroll.actor
    exchange: scroll.statement
    retryConfig:
      type: COUNT_LIMITED_EXPONENTIAL_BACKOFF
      maxAttempts: 6
      multipier: 10
      maxTimeBetweenRetries: 10s

requestProcessorConfig:
  actorConfigs:
    TAG_UPDATE:
      prefetchCount: 1
      concurrency: 5
      prefix: scroll.actor
      exchange: scroll.requests
      retryConfig:
        type: NO_RETRY
    ATTACHMENT_ACK:
      prefetchCount: 1
      concurrency: 2
      prefix: scroll.actor
      exchange: scroll.attachment
      retryConfig:
        type: COUNT_LIMITED_EXPONENTIAL_BACKOFF
        maxAttempts: 6
        multipier: 100
        maxTimeBetweenRetries: 20s

contentStoreConfig:
  namespace: scroll
  docStoreDownloadUrl: http://docstore.traefik.stg.phonepe.nm3/v1/documents/
  callbackUrl: http://scroll.traefik.stg.phonepe.com/callback/v1/flipcast/ack
  docStoreConfig:
    environment: stage
    zkEnabled: false
    endpoint: http://docstore.traefik.stg.phonepe.nm3

hystrixConfig:
  defaultConfig:
    threadPool:
      timeout: 10000
      concurrency: 32
